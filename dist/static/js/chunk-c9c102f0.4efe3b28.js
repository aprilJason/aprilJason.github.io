(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c9c102f0"],{1:function(e,t){},1276:function(e,t,a){"use strict";var n=a("c65b"),i=a("e330"),l=a("d784"),r=a("825a"),o=a("7234"),s=a("1d80"),c=a("4840"),u=a("8aa5"),h=a("50c4"),d=a("577e"),f=a("dc4a"),p=a("14c3"),b=a("9f7f"),g=a("d039"),m=b.UNSUPPORTED_Y,v=4294967295,w=Math.min,y=i([].push),x=i("".slice),S=!g((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2!==a.length||"a"!==a[0]||"b"!==a[1]})),D="c"==="abbc".split(/(b)*/)[1]||4!=="test".split(/(?:)/,-1).length||2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length;l("split",(function(e,t,a){var i="0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:n(t,this,e,a)}:t;return[function(t,a){var l=s(this),r=o(t)?void 0:f(t,e);return r?n(r,t,l,a):n(i,d(l),t,a)},function(e,n){var l=r(this),o=d(e);if(!D){var s=a(i,l,o,n,i!==t);if(s.done)return s.value}var f=c(l,RegExp),b=l.unicode,g=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(m?"g":"y"),S=new f(m?"^(?:"+l.source+")":l,g),k=void 0===n?v:n>>>0;if(0===k)return[];if(0===o.length)return null===p(S,o)?[o]:[];var z=0,C=0,O=[];while(C<o.length){S.lastIndex=m?0:C;var _,B=p(S,m?x(o,C):o);if(null===B||(_=w(h(S.lastIndex+(m?C:0)),o.length))===z)C=u(o,C,b);else{if(y(O,x(o,z,C)),O.length===k)return O;for(var E=1;E<=B.length-1;E++)if(y(O,B[E]),O.length===k)return O;C=z=_}}return y(O,x(o,z)),O}]}),D||!S,m)},2:function(e,t){},3:function(e,t){},"35b3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"upload-excel-header"},[a("upload-excel-component",{attrs:{"on-success":e.handleSuccess,"before-upload":e.beforeUpload}}),a("div",{staticClass:"rule-section"},[a("label",[e._v("边框规格:")]),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleBorderSizeChange},model:{value:e.selectBorderSize,callback:function(t){e.selectBorderSize=t},expression:"selectBorderSize"}},e._l(e.borderSizeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"rule-section"},[a("label",[e._v("芯板规格:")]),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handlePanelSizeChange},model:{value:e.selectPanelSize,callback:function(t){e.selectPanelSize=t},expression:"selectPanelSize"}},e._l(e.panelSizeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"rule-section"},[a("label",[e._v("边框长度:")]),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleBorderLengthChange},model:{value:e.selectBorderLength,callback:function(t){e.selectBorderLength=t},expression:"selectBorderLength"}},e._l(e.borderLengthOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v(" 导出表单 ")]),a("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleExportImage}},[e._v(" 导出图片 ")])],1),a("div",{attrs:{id:"table-container"}},[e.tableData?a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData,border:"","highlight-current-row":"","show-summary":"","sum-text":"合计","summary-method":e.getSummaries}},e._l(e.tableHeader,(function(e){return a("el-table-column",{key:e,attrs:{prop:e,label:e}})})),1):e._e()],1),a("el-dialog",{attrs:{title:"请输入导出表单文件名",visible:e.exportImagedialogVisible,width:"30%","before-close":e.handleCancelDownImage},on:{"update:visible":function(t){e.exportImagedialogVisible=t}}},[a("el-input",{model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancelDownImage}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleDownloadImage}},[e._v("确 定")])],1)],1)],1)},i=[],l=a("2909"),r=(a("99af"),a("cb29"),a("7db0"),a("d81d"),a("14d9"),a("13d5"),a("a434"),a("e9c4"),a("a9e3"),a("b64b"),a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("159b"),a("ddb0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"excel-upload"},[a("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}}),a("el-button",{staticStyle:{"margin-left":"16px"},attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.handleUpload}},[e._v(" 上传表单 ")])],1)}),o=[],s=(a("b0c0"),a("00b4"),a("1146")),c=a.n(s),u={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(e){var t=e.header,a=e.results;this.excelData.header=t,this.excelData.results=a,this.onSuccess&&this.onSuccess(this.excelData)},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(e){var t=e.target.files,a=t[0];a&&this.upload(a)},upload:function(e){if(this.$refs["excel-upload-input"].value=null,this.beforeUpload){var t=this.beforeUpload(e);t&&this.readerData(e)}else this.readerData(e)},readerData:function(e){var t=this;return this.loading=!0,new Promise((function(a,n){var i=new FileReader;i.onload=function(e){console.log(e,"------e");var n=e.target.result,i=c.a.read(n,{type:"array"}),l=i.SheetNames[0],r=i.Sheets[l],o=t.getHeaderRow(r),s=c.a.utils.sheet_to_json(r);t.generateData({header:o,results:s}),t.loading=!1,a()},i.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,a=[],n=c.a.utils.decode_range(e["!ref"]),i=n.s.r;for(t=n.s.c;t<=n.e.c;++t){var l=e[c.a.utils.encode_cell({c:t,r:i})],r="UNKNOWN "+t;l&&l.t&&(r=c.a.utils.format_cell(l)),a.push(r)}return a},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},h=u,d=(a("8e52"),a("2877")),f=Object(d["a"])(h,r,o,!1,null,"4e07f464",null),p=f.exports,b=a("b85c"),g=a("a38e");function m(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Object(g["a"])(n.key),n)}}function v(e,t,a){return t&&m(e.prototype,t),a&&m(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}a("d9e2");function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a("4e82"),a("1276");var y=v((function e(t,a){w(this,e),this.width=t,this.height=a})),x=function(){function e(t,a,n,i){w(this,e),this.x=t,this.y=a,this.width=n,this.height=i,this.used=!1,this.right=null,this.down=null}return v(e,[{key:"split",value:function(t){this.used=!0,this.down=new e(this.x,this.y+t.height,this.width,this.height-t.height),this.right=new e(this.x+t.width,this.y,this.width-t.width,t.height)}},{key:"fit",value:function(e){return this.used?this.right.fit(e)||this.down.fit(e):e.width<=this.width&&e.height<=this.height&&(this.split(e),!0)}}])}(),S=function(){function e(t,a){w(this,e),this.root=new x(0,0,t,a)}return v(e,[{key:"pack",value:function(e){var t,a=Object(b["a"])(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(!this.root.fit(n))return!1}}catch(i){a.e(i)}finally{a.f()}return!0}}])}();function D(e,t,a){a.sort((function(e,t){return t.width*t.height-e.width*e.height}));var n,i,l=[],r=Object(b["a"])(a);try{for(r.s();!(i=r.n()).done;){var o=i.value;n&&n.pack([o])||(n=new S(e,t),n.pack([o]),l.push(n))}}catch(s){r.e(s)}finally{r.f()}return l.length}var k=a("c0e9"),z=a.n(k),C={name:"UploadExcel",components:{UploadExcelComponent:p},data:function(){return{downloadLoading:!1,tableData:[],tableHeader:[],panelSizeOptions:[{value:"1",height:2440,width:1220,label:"2440*1220"},{value:"2",height:2750,width:1220,label:"2750*1220"}],borderSizeOptions:[{value:"1",width:55,label:"50 韩式-01,宽度55mm"},{value:"2",width:49,label:"汉角现代 B-02,宽度49mm"},{value:"3",width:107,label:"60 边框-03,宽度107mm"},{value:"4",width:37,label:"50D-04,宽度37mm"},{value:"5",width:87,label:"50L-05,宽度87mm"},{value:"6",width:6,label:"50E-06,宽度6mm"},{value:"7",width:23,label:"45E-07,宽度23mm"},{value:"8",width:85,label:"50边框-08,宽度85mm"},{value:"9",width:115,label:"60小鸟-09,宽度115mm"},{value:"10",width:115,label:"65 边框-10,宽度115mm"},{value:"11",width:115,label:"65美式-11,宽度115mm"},{value:"12",width:18,label:"45骨骼线-12,宽度18mm"},{value:"13",width:29,label:"50骨骼线-13,宽度29mm"},{value:"14",width:21,label:"极简-14,宽度21mm"},{value:"15",width:9,label:"极简-15,宽度9mm"},{value:"16",width:40,label:"新中式-16,宽度40mm"},{value:"17",width:23,label:"50*33*18-17,宽度23mm"}],borderLengthOptions:[{value:"1",length:2440,label:"2440"},{value:"2",length:2750,label:"2750"}],panelSize:{width:100,height:100},selectPanelSize:"1",selectBorderSize:"1",selectBorderLength:"1",exportImagedialogVisible:!1,filename:""}},methods:{beforeUpload:function(e){var t=e.size/1024/1024<1;return!!t||(this.$message({message:"Please do not upload files larger than 1m in size.",type:"warning"}),!1)},handleSuccess:function(e){var t=this,a=e.results,n=e.header,i=this.panelSizeOptions.find((function(e){return e.value===t.selectPanelSize})),l=this.borderSizeOptions.find((function(e){return e.value===t.selectBorderSize})),r=l.width;n.push("芯板规格"),n.push("芯板高"),n.push("芯板宽"),n.push("芯板数量"),n.push("边框规格"),n.push("边框条数"),n.splice(n.indexOf("单价"),1),n.splice(n.indexOf("总价"),1),a.forEach((function(e){e["芯板规格"]=i.height+"*"+i.width,e["芯板高"]=e["高"]-r,e["芯板宽"]=e["宽"]-r,e["芯板数量"]="",e["边框规格"]=r,e["边框条数"]="",delete e["单价"],delete e["总价"]})),this.tableData=a,this.tableHeader=n},getPanelCount:function(e){var t=this,a=this.panelSizeOptions.find((function(e){return e.value===t.selectPanelSize})),n=a.width,i=a.height,l=[];e.forEach((function(e){l.push(new y(e[0],e[1]))}));var r=D(n,i,l);return r},getBorderCount:function(e){var t=this,a=this.borderLengthOptions.find((function(e){return e.value===t.selectBorderLength})),n=a.length,i=e.reduce((function(e,t){return e+t}),0),l=Array(i+1).fill(1/0);l[0]=0;for(var r=1;r<=i;r++)for(var o=1;o<=Math.min(n,r);o++)r>=o&&l[r-o]!==1/0&&(l[r]=Math.min(l[r],l[r-o]+1));return l[i]},getSummaries:function(e){var t=this,a=e.columns,n=[],i=[],l=[];return this.tableData.forEach((function(e){i=i.concat(new Array(2*e["数量"]).fill(Number(e["宽"]))),i=i.concat(new Array(2*e["数量"]).fill(Number(e["高"]))),l=l.concat(new Array(Number(e["数量"])).fill([Number(e["芯板宽"]),Number(e["芯板高"])]))})),a.forEach((function(e,a){n[a]=0!==a?13===a?t.getBorderCount(i):11===a?t.getPanelCount(l):"":"合计"})),n},handlePanelSizeChange:function(){this.tableData=Object(l["a"])(this.tableData)},handleBorderLengthChange:function(){this.tableData=Object(l["a"])(this.tableData)},handleBorderSizeChange:function(e){var t=this,a=this.borderSizeOptions.find((function(e){return e.value===t.selectBorderSize}));this.tableData.forEach((function(e){e["边框规格"]=a.width,e["芯板高"]=e["高"]-a.width,e["芯板宽"]=e["宽"]-a.width})),this.tableData=Object(l["a"])(this.tableData)},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},handleDownload:function(){var e=this;this.downloadLoading=!0;var t=[],n=[];this.tableData.forEach((function(e){t=t.concat(new Array(2*e["数量"]).fill(Number(e["宽"]))),t=t.concat(new Array(2*e["数量"]).fill(Number(e["高"]))),n=n.concat(new Array(Number(e["数量"])).fill([Number(e["芯板宽"]),Number(e["芯板高"])]))})),Promise.all([a.e("chunk-61b10379"),a.e("chunk-2d0cc0b6")]).then(a.bind(null,"4bf8")).then((function(a){var i=["序号","高","宽","数量","开孔","颜色","备注","面积","芯板规格","芯板宽","芯板高","芯板数量","边框规格","边框条数"],l=["序号","高","宽","数量","开孔","颜色","备注","面积","芯板规格","芯板宽","芯板高","芯板数量","边框规格","边框条数"],r={};i.forEach((function(a,i){0===i?r[a]="合计":13===i?r[a]=e.getBorderCount(t):11===i&&(r[a]=e.getPanelCount(n))}));var o=JSON.parse(JSON.stringify(e.tableData));o.push(r);var s=e.formatJson(l,o);a.export_json_to_excel({header:i,data:s,filename:e.filename,autoWidth:e.autoWidth,bookType:e.bookType}),e.downloadLoading=!1}))},handleExportImage:function(){this.loadingImage=!0,this.exportImagedialogVisible=!0,this.$forceUpdate()},handleCancelDownImage:function(){this.loadingImage=!1,this.exportImagedialogVisible=!1,this.$forceUpdate()},handleDownloadImage:function(){var e=this;z()(document.getElementById("table-container")).then((function(t){var a=document.createElement("a");a.href=t.toDataURL("image/png").replace("image/png","image/octet-stream"),a.download=e.filename+".png",a.click(),e.loadingImage=!1,e.exportImagedialogVisible=!1}))}}},O=C,_=(a("36fa"),Object(d["a"])(O,n,i,!1,null,null,null));t["default"]=_.exports},"36fa":function(e,t,a){"use strict";a("7873")},7873:function(e,t,a){},"7db0":function(e,t,a){"use strict";var n=a("23e7"),i=a("b727").find,l=a("44d2"),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),l(r)},"8e52":function(e,t,a){"use strict";a("e558")},cb29:function(e,t,a){"use strict";var n=a("23e7"),i=a("81d5"),l=a("44d2");n({target:"Array",proto:!0},{fill:i}),l("fill")},e558:function(e,t,a){}}]);