(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c9c102f0"],{1:function(e,t){},1276:function(e,t,n){"use strict";var a=n("d784"),i=n("44e7"),l=n("825a"),r=n("1d80"),o=n("4840"),s=n("8aa5"),u=n("50c4"),c=n("14c3"),h=n("9263"),d=n("d039"),f=[].push,p=Math.min,g=4294967295,b=!d((function(){return!RegExp(g,"y")}));a("split",2,(function(e,t,n){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var a=String(r(this)),l=void 0===n?g:n>>>0;if(0===l)return[];if(void 0===e)return[a];if(!i(e))return t.call(a,e,l);var o,s,u,c=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,b=new RegExp(e.source,d+"g");while(o=h.call(b,a)){if(s=b.lastIndex,s>p&&(c.push(a.slice(p,o.index)),o.length>1&&o.index<a.length&&f.apply(c,o.slice(1)),u=o[0].length,p=s,c.length>=l))break;b.lastIndex===o.index&&b.lastIndex++}return p===a.length?!u&&b.test("")||c.push(""):c.push(a.slice(p)),c.length>l?c.slice(0,l):c}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=r(this),l=void 0==t?void 0:t[e];return void 0!==l?l.call(t,i,n):a.call(String(i),t,n)},function(e,i){var r=n(a,e,this,i,a!==t);if(r.done)return r.value;var h=l(e),d=String(this),f=o(h,RegExp),m=h.unicode,v=(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(b?"y":"g"),w=new f(b?h:"^(?:"+h.source+")",v),x=void 0===i?g:i>>>0;if(0===x)return[];if(0===d.length)return null===c(w,d)?[d]:[];var y=0,S=0,k=[];while(S<d.length){w.lastIndex=b?S:0;var D,C=c(w,b?d:d.slice(S));if(null===C||(D=p(u(w.lastIndex+(b?0:S)),d.length))===y)S=s(d,S,m);else{if(k.push(d.slice(y,S)),k.length===x)return k;for(var z=1;z<=C.length-1;z++)if(k.push(C[z]),k.length===x)return k;S=y=D}}return k.push(d.slice(y)),k}]}),!b)},2:function(e,t){},3:function(e,t){},"35b3":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"upload-excel-header"},[n("upload-excel-component",{attrs:{"on-success":e.handleSuccess,"before-upload":e.beforeUpload}}),n("div",{staticClass:"rule-section"},[n("label",[e._v("边框规格:")]),n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleBorderSizeChange},model:{value:e.selectBorderSize,callback:function(t){e.selectBorderSize=t},expression:"selectBorderSize"}},e._l(e.borderSizeOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("div",{staticClass:"rule-section"},[n("label",[e._v("芯板规格:")]),n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handlePanelSizeChange},model:{value:e.selectPanelSize,callback:function(t){e.selectPanelSize=t},expression:"selectPanelSize"}},e._l(e.panelSizeOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("div",{staticClass:"rule-section"},[n("label",[e._v("边框长度:")]),n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleBorderLengthChange},model:{value:e.selectBorderLength,callback:function(t){e.selectBorderLength=t},expression:"selectBorderLength"}},e._l(e.borderLengthOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v(" 导出表单 ")]),n("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleExportImage}},[e._v(" 导出图片 ")])],1),n("div",{attrs:{id:"table-container"}},[e.tableData?n("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData,border:"","highlight-current-row":"","show-summary":"","sum-text":"合计","summary-method":e.getSummaries}},e._l(e.tableHeader,(function(e){return n("el-table-column",{key:e,attrs:{prop:e,label:e}})})),1):e._e()],1),n("el-dialog",{attrs:{title:"请输入导出表单文件名",visible:e.exportImagedialogVisible,width:"30%","before-close":e.handleCancelDownImage},on:{"update:visible":function(t){e.exportImagedialogVisible=t}}},[n("el-input",{model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleCancelDownImage}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleDownloadImage}},[e._v("确 定")])],1)],1)],1)},i=[],l=n("2909"),r=(n("99af"),n("cb29"),n("7db0"),n("d81d"),n("13d5"),n("a434"),n("e9c4"),n("a9e3"),n("b64b"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("159b"),n("ddb0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"excel-upload"},[n("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}}),n("el-button",{staticStyle:{"margin-left":"16px"},attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.handleUpload}},[e._v(" 上传表单 ")])],1)}),o=[],s=(n("b0c0"),n("00b4"),n("1146")),u=n.n(s),c={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(e){var t=e.header,n=e.results;this.excelData.header=t,this.excelData.results=n,this.onSuccess&&this.onSuccess(this.excelData)},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(e){var t=e.target.files,n=t[0];n&&this.upload(n)},upload:function(e){if(this.$refs["excel-upload-input"].value=null,this.beforeUpload){var t=this.beforeUpload(e);t&&this.readerData(e)}else this.readerData(e)},readerData:function(e){var t=this;return this.loading=!0,new Promise((function(n,a){var i=new FileReader;i.onload=function(e){console.log(e,"------e");var a=e.target.result,i=u.a.read(a,{type:"array"}),l=i.SheetNames[0],r=i.Sheets[l],o=t.getHeaderRow(r),s=u.a.utils.sheet_to_json(r);t.generateData({header:o,results:s}),t.loading=!1,n()},i.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,n=[],a=u.a.utils.decode_range(e["!ref"]),i=a.s.r;for(t=a.s.c;t<=a.e.c;++t){var l=e[u.a.utils.encode_cell({c:t,r:i})],r="UNKNOWN "+t;l&&l.t&&(r=u.a.utils.format_cell(l)),n.push(r)}return n},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},h=c,d=(n("8e52"),n("2877")),f=Object(d["a"])(h,r,o,!1,null,"4e07f464",null),p=f.exports,g=n("b85c"),b=n("a38e");function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Object(b["a"])(a.key),a)}}function v(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n("4e82"),n("1276");var x=v((function e(t,n){w(this,e),this.width=t,this.height=n})),y=function(){function e(t,n,a,i){w(this,e),this.x=t,this.y=n,this.width=a,this.height=i,this.used=!1,this.right=null,this.down=null}return v(e,[{key:"split",value:function(t){this.used=!0,this.down=new e(this.x,this.y+t.height,this.width,this.height-t.height),this.right=new e(this.x+t.width,this.y,this.width-t.width,t.height)}},{key:"fit",value:function(e){return this.used?this.right.fit(e)||this.down.fit(e):e.width<=this.width&&e.height<=this.height&&(this.split(e),!0)}}])}(),S=function(){function e(t,n){w(this,e),this.root=new y(0,0,t,n)}return v(e,[{key:"pack",value:function(e){var t,n=Object(g["a"])(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(!this.root.fit(a))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}])}();function k(e,t,n){n.sort((function(e,t){return t.width*t.height-e.width*e.height}));var a,i,l=[],r=Object(g["a"])(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;a&&a.pack([o])||(a=new S(e,t),a.pack([o]),l.push(a))}}catch(s){r.e(s)}finally{r.f()}return l.length}var D=n("c0e9"),C=n.n(D),z={name:"UploadExcel",components:{UploadExcelComponent:p},data:function(){return{downloadLoading:!1,tableData:[],tableHeader:[],panelSizeOptions:[{value:"1",height:2440,width:1220,label:"2440*1220"},{value:"2",height:2750,width:1220,label:"2750*1220"}],borderSizeOptions:[{value:"1",width:55,label:"50 韩式-01,宽度55mm"},{value:"2",width:49,label:"汉角现代 B-02,宽度49mm"},{value:"3",width:107,label:"60 边框-03,宽度107mm"},{value:"4",width:37,label:"50D-04,宽度37mm"},{value:"5",width:87,label:"50L-05,宽度87mm"},{value:"6",width:6,label:"50E-06,宽度6mm"},{value:"7",width:23,label:"45E-07,宽度23mm"},{value:"8",width:85,label:"50边框-08,宽度85mm"},{value:"9",width:115,label:"60小鸟-09,宽度115mm"},{value:"10",width:115,label:"65 边框-10,宽度115mm"},{value:"11",width:115,label:"65美式-11,宽度115mm"},{value:"12",width:18,label:"45骨骼线-12,宽度18mm"},{value:"13",width:29,label:"50骨骼线-13,宽度29mm"},{value:"14",width:21,label:"极简-14,宽度21mm"},{value:"15",width:9,label:"极简-15,宽度9mm"},{value:"16",width:40,label:"新中式-16,宽度40mm"},{value:"17",width:23,label:"50*33*18-17,宽度23mm"}],borderLengthOptions:[{value:"1",length:2440,label:"2440"},{value:"2",length:2750,label:"2750"}],panelSize:{width:100,height:100},selectPanelSize:"1",selectBorderSize:"1",selectBorderLength:"1",exportImagedialogVisible:!1,filename:""}},methods:{beforeUpload:function(e){var t=e.size/1024/1024<1;return!!t||(this.$message({message:"Please do not upload files larger than 1m in size.",type:"warning"}),!1)},handleSuccess:function(e){var t=this,n=e.results,a=e.header,i=this.panelSizeOptions.find((function(e){return e.value===t.selectPanelSize})),l=this.borderSizeOptions.find((function(e){return e.value===t.selectBorderSize})),r=l.width;a.push("芯板规格"),a.push("芯板高"),a.push("芯板宽"),a.push("芯板数量"),a.push("边框规格"),a.push("边框条数"),a.splice(a.indexOf("单价"),1),a.splice(a.indexOf("总价"),1),n.forEach((function(e){e["芯板规格"]=i.height+"*"+i.width,e["芯板高"]=e["高"]-r,e["芯板宽"]=e["宽"]-r,e["芯板数量"]="",e["边框规格"]=r,e["边框条数"]="",delete e["单价"],delete e["总价"]})),this.tableData=n,this.tableHeader=a},getPanelCount:function(e){var t=this,n=this.panelSizeOptions.find((function(e){return e.value===t.selectPanelSize})),a=n.width,i=n.height,l=[];e.forEach((function(e){l.push(new x(e[0],e[1]))}));var r=k(a,i,l);return r},getBorderCount:function(e){var t=this,n=this.borderLengthOptions.find((function(e){return e.value===t.selectBorderLength})),a=n.length,i=e.reduce((function(e,t){return e+t}),0),l=Array(i+1).fill(1/0);l[0]=0;for(var r=1;r<=i;r++)for(var o=1;o<=Math.min(a,r);o++)r>=o&&l[r-o]!==1/0&&(l[r]=Math.min(l[r],l[r-o]+1));return l[i]},getSummaries:function(e){var t=this,n=e.columns,a=[],i=[],l=[];return this.tableData.forEach((function(e){i=i.concat(new Array(2*e["数量"]).fill(Number(e["宽"]))),i=i.concat(new Array(2*e["数量"]).fill(Number(e["高"]))),l=l.concat(new Array(Number(e["数量"])).fill([Number(e["芯板宽"]),Number(e["芯板高"])]))})),n.forEach((function(e,n){a[n]=0!==n?13===n?t.getBorderCount(i):11===n?t.getPanelCount(l):"":"合计"})),a},handlePanelSizeChange:function(){this.tableData=Object(l["a"])(this.tableData)},handleBorderLengthChange:function(){this.tableData=Object(l["a"])(this.tableData)},handleBorderSizeChange:function(e){var t=this,n=this.borderSizeOptions.find((function(e){return e.value===t.selectBorderSize}));this.tableData.forEach((function(e){e["边框规格"]=n.width,e["芯板高"]=e["高"]-n.width,e["芯板宽"]=e["宽"]-n.width})),this.tableData=Object(l["a"])(this.tableData)},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},handleDownload:function(){var e=this;this.downloadLoading=!0;var t=[],a=[];this.tableData.forEach((function(e){t=t.concat(new Array(2*e["数量"]).fill(Number(e["宽"]))),t=t.concat(new Array(2*e["数量"]).fill(Number(e["高"]))),a=a.concat(new Array(Number(e["数量"])).fill([Number(e["芯板宽"]),Number(e["芯板高"])]))})),Promise.all([n.e("chunk-1b026064"),n.e("chunk-2d0cc0b6")]).then(n.bind(null,"4bf8")).then((function(n){var i=["序号","高","宽","数量","开孔","颜色","备注","面积","芯板规格","芯板宽","芯板高","芯板数量","边框规格","边框条数"],l=["序号","高","宽","数量","开孔","颜色","备注","面积","芯板规格","芯板宽","芯板高","芯板数量","边框规格","边框条数"],r={};i.forEach((function(n,i){0===i?r[n]="合计":13===i?r[n]=e.getBorderCount(t):11===i&&(r[n]=e.getPanelCount(a))}));var o=JSON.parse(JSON.stringify(e.tableData));o.push(r);var s=e.formatJson(l,o);n.export_json_to_excel({header:i,data:s,filename:e.filename,autoWidth:e.autoWidth,bookType:e.bookType}),e.downloadLoading=!1}))},handleExportImage:function(){this.loadingImage=!0,this.exportImagedialogVisible=!0,this.$forceUpdate()},handleCancelDownImage:function(){this.loadingImage=!1,this.exportImagedialogVisible=!1,this.$forceUpdate()},handleDownloadImage:function(){var e=this;C()(document.getElementById("table-container")).then((function(t){var n=document.createElement("a");n.href=t.toDataURL("image/png").replace("image/png","image/octet-stream"),n.download=e.filename+".png",n.click(),e.loadingImage=!1,e.exportImagedialogVisible=!1}))}}},O=z,_=(n("36fa"),Object(d["a"])(O,a,i,!1,null,null,null));t["default"]=_.exports},"36fa":function(e,t,n){"use strict";n("7873")},7873:function(e,t,n){},"7db0":function(e,t,n){"use strict";var a=n("23e7"),i=n("b727").find,l=n("44d2"),r=n("ae40"),o="find",s=!0,u=r(o);o in[]&&Array(1)[o]((function(){s=!1})),a({target:"Array",proto:!0,forced:s||!u},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),l(o)},"8e52":function(e,t,n){"use strict";n("e558")},cb29:function(e,t,n){var a=n("23e7"),i=n("81d5"),l=n("44d2");a({target:"Array",proto:!0},{fill:i}),l("fill")},e558:function(e,t,n){}}]);